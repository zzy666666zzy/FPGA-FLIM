#include "stdio.h"
#include "AdderNet.h"
#include "Toptop.h"
#include "Pre1.h"

int main(void)
{
	Dtype_f tau_inten[Hout_O1_3][Wout_O1_3][CHout_O1_3];
	Dtype_f tau_amp[Hout_O1_3][Wout_O1_3][CHout_O1_3];
	Dtype_f lifetime_o1[2];
	Dtype_f lifetime_o2[2];
	Dtype_f lifetime_o3[2];
	Dtype_f lifetime_o4[2];

	//GPU result 0.20275, 1.29789
	Dtype_f_pre1_i feature_in1[Hin_Pre1][Win_Pre1]={0.0065789,0.0098684,0.0098684,0.023026,0.036184,0.013158,0.016447,0.016447,0.016447,0.019737,0.042763,0.12171,0.40461,0.89803,1,0.80263,0.41447,0.25658,0.15461,0.11184,0.098684,0.069079,0.049342,0.046053,0.055921,0.042763,0.023026,0.023026,0.016447,0.019737,0.029605,0.029605,0.023026,0.013158,0.039474,0.016447,0.0098684,0.036184,0.029605,0.029605,0.036184,0.042763,0.055921,0.016447,0.023026,0.042763,0.019737,0.013158,0.026316,0.013158,0.013158,0.0098684,0.013158,0.0098684,0.023026,0.013158,0.036184,0.023026,0.0098684,0.013158,0.013158,0.032895,0.0098684,0.016447,0.023026,0.026316,0.013158,0.0098684,0.019737,0.0098684,0.0065789,0.0065789,0.0065789,0.0065789,0.0098684,0.013158,0.0098684,0.0065789,0.0065789,0.0098684,0.0065789,0.016447,0.013158,0.016447,0.0065789,0.0065789,0.013158,0.0032895,0.0032895,0.0098684,0.016447,0.013158,0.013158,0.0098684,0.0098684,0.0065789,0,0.013158,0.0065789,0.0098684,0,0.0065789,0.0032895,0.0098684,0.0065789,0.013158,0.0065789,0.0098684,0.0065789,0.013158,0.0098684,0.016447,0.0098684,0.013158,0.016447,0.0098684,0.0065789,0.0065789,0.0032895,0.0032895,0.0032895,0,0.0065789,0,0.0032895,0,0.0098684,0.0065789,0.0098684,0.0065789,0.0032895,0.0098684,0,0.0098684,0,0.0032895,0,0.016447,0.0065789,0.0065789,0.0065789,0,0.0032895,0.0032895,0,0.0032895,0,0,0,0,0.0098684,0.0065789,0.0065789,0.0098684,0,0,0.0032895,0.0065789,0.0032895,0.0098684,0,0.0098684,0,0.0065789,0,0.0065789,0,0,0.0032895,0,0.0065789,0,0,0,0.0098684,0,0.0032895,0.0032895,0.0032895,0,0,0.0032895,0.0032895,0,0.0032895,0.0065789,0.0065789,0.0032895,0.0032895,0.0032895,0.0032895,0.0032895,0,0,0,0,0,0.0032895,0.0032895,0.0032895,0.0032895,0,0.0032895,0.0032895,0.0032895,0.0065789,0.0032895,0.0065789,0.0065789,0,0.0032895,0,0,0,0,0.0065789,0.0032895,0.0065789,0.0065789,0,0,0.0032895,0.0032895,0,0.0065789,0.0032895,0.0032895,0,0.0032895,0.0098684,0,0.0032895,0.0032895,0,0.0032895,0.0065789,0.0032895,0.0032895,0,0,0,0,0.0065789,0,0.0032895,0,0,0.0032895,0,0,0,0.0032895,0,0,0,0};
	//GPU result 0.38197, 1.96506
	Dtype_f_pre1_i feature_in2[Hin_Pre1][Win_Pre1]={0,0.02439,0.012195,0.02439,0.012195,0,0,0.02439,0.02439,0.036585,0.073171,0.14634,0.43902,0.82927,1,0.79268,0.52439,0.37805,0.2561,0.12195,0.17073,0.15854,0.10976,0.14634,0.15854,0.12195,0.12195,0.085366,0.085366,0.10976,0.060976,0.12195,0.097561,0.073171,0.097561,0.097561,0.085366,0.060976,0.17073,0.02439,0.04878,0.073171,0.04878,0.036585,0.085366,0.085366,0.073171,0.04878,0.02439,0.060976,0.073171,0.10976,0.073171,0.073171,0.060976,0,0.012195,0.04878,0.085366,0.02439,0.036585,0.036585,0.085366,0,0.060976,0.036585,0.036585,0.04878,0.02439,0.036585,0.02439,0.04878,0.036585,0.012195,0.04878,0.036585,0.02439,0.036585,0.02439,0.060976,0.060976,0.02439,0.04878,0.02439,0.04878,0.036585,0.04878,0.012195,0.02439,0.060976,0.036585,0.012195,0.060976,0.036585,0.036585,0.036585,0.060976,0.02439,0.02439,0.02439,0.060976,0.02439,0.036585,0.012195,0.012195,0.012195,0.04878,0.036585,0.02439,0.02439,0.02439,0.036585,0.02439,0.02439,0.036585,0.02439,0.04878,0,0.02439,0,0.02439,0,0.012195,0.012195,0.02439,0.012195,0,0.02439,0.02439,0.036585,0.036585,0,0.02439,0.012195,0.02439,0,0,0,0,0.02439,0.036585,0.012195,0.036585,0.02439,0,0,0,0.012195,0.012195,0.02439,0,0.012195,0,0,0,0.012195,0.012195,0.012195,0.02439,0.02439,0.060976,0.02439,0.02439,0.02439,0.02439,0.02439,0.012195,0.012195,0.036585,0.012195,0.012195,0.036585,0.02439,0,0,0.012195,0.012195,0,0.012195,0,0,0.012195,0.012195,0,0.02439,0.02439,0.02439,0.012195,0,0.012195,0.02439,0.012195,0.02439,0.012195,0,0.02439,0.02439,0,0.012195,0,0.012195,0,0,0,0.012195,0.012195,0.012195,0,0,0,0,0,0,0,0.012195,0,0.012195,0,0,0,0,0.02439,0.012195,0.012195,0.012195,0,0.036585,0,0.012195,0.02439,0,0,0.012195,0,0.012195,0.02439,0.012195,0,0,0.036585,0.02439,0,0.012195,0,0.012195,0.02439,0,0.012195,0,0,0,0,0,0,0,0};
	//GPU result 0.95743, 1.19885
	Dtype_f_pre1_i feature_in3[Hin_Pre1][Win_Pre1]={0,0,0,0,0,0,0,0,0.003876,0.0232558,0.1046512,0.2054264,0.3643411,0.6085271,0.8217054,0.8682171,1,0.9573643,0.9069767,0.8604651,0.8139535,0.7674419,0.7286822,0.6705426,0.6666667,0.6705426,0.7093023,0.5658915,0.5813953,0.6007752,0.5775194,0.4534884,0.4767442,0.4263566,0.5077519,0.4108527,0.4031008,0.4069767,0.3992248,0.3604651,0.4379845,0.3914729,0.3410853,0.2945736,0.3372093,0.3604651,0.3565891,0.3139535,0.244186,0.2713178,0.2906977,0.2286822,0.2054264,0.248062,0.2364341,0.2403101,0.2209302,0.2131783,0.2054264,0.1899225,0.1976744,0.1899225,0.2054264,0.120155,0.1899225,0.2131783,0.127907,0.1317829,0.127907,0.1317829,0.1472868,0.124031,0.120155,0.1046512,0.127907,0.1085271,0.1162791,0.124031,0.1317829,0.1046512,0.0891473,0.1046512,0.0775194,0.0968992,0.0697674,0.0775194,0.0852713,0.120155,0.0775194,0.0775194,0.0736434,0.0697674,0.0736434,0.0542636,0.0852713,0.1007752,0.0658915,0.0542636,0.0426357,0.0736434,0.0465116,0.0387597,0.0542636,0.0891473,0.0426357,0.0542636,0.0348837,0.0465116,0.0465116,0.0348837,0.0387597,0.0348837,0.0426357,0.0348837,0.0348837,0.0465116,0.0426357,0.0542636,0.0465116,0.0193798,0.0387597,0.0581395,0.0348837,0.0387597,0.0387597,0.0116279,0.0310078,0.0232558,0.0271318,0.0155039,0.0310078,0.0155039,0.0155039,0.0426357,0.0387597,0.0348837,0.0116279,0.0310078,0.0155039,0.0193798,0.0116279,0.0193798,0.003876,0.0232558,0.0348837,0.0077519,0.0077519,0.0193798,0.0271318,0.0077519,0.0232558,0.0348837,0.0193798,0.0116279,0.0232558,0.0155039,0.0155039,0.0116279,0.003876,0.0193798,0.003876,0.0077519,0.0116279,0.0116279,0.0116279,0.0155039,0.0116279,0,0.0271318,0.0077519,0.003876,0,0.003876,0.003876,0.003876,0.0155039,0.0155039,0.0116279,0.0077519,0.0077519,0.0116279,0,0,0.0077519,0.0077519,0.003876,0,0,0.0077519,0.003876,0.003876,0.0116279,0,0.0271318,0.003876,0.003876,0.003876,0,0.003876,0,0.0116279,0.003876,0.003876,0.0077519,0,0.003876,0.003876,0,0,0.0077519,0.003876,0,0,0.003876,0,0,0,0,0,0,0,0.003876,0.003876,0,0,0,0,0,0.003876,0.003876,0,0,0,0.003876,0,0,0,0,0,0,0,0,0,0,0,0.0077519,0,0,0,0,0,0.003876,0,0,0,0};
	//GPU result 1.21151, 1.33135
	Dtype_f_pre1_i feature_in4[Hin_Pre1][Win_Pre1]={0,0,0,0,0,0,0,0,0,0,0.0292887,0.083682,0.2468619,0.5230126,0.6485356,0.7949791,0.9665272,0.9832636,0.9790795,1,0.8870293,0.9246862,0.7112971,0.6987448,0.6694561,0.7866109,0.6987448,0.6820084,0.707113,0.6694561,0.6359833,0.5606695,0.5439331,0.5439331,0.6276151,0.623431,0.5690377,0.5020921,0.4811715,0.3933054,0.4686192,0.5230126,0.3556485,0.3974895,0.4435146,0.4016736,0.3263598,0.3849372,0.3221757,0.3012552,0.3598326,0.2970711,0.3389121,0.2552301,0.2803347,0.3054393,0.2384937,0.3012552,0.2803347,0.3263598,0.2301255,0.2343096,0.209205,0.2426778,0.2050209,0.2384937,0.1966527,0.2217573,0.1799163,0.209205,0.167364,0.1882845,0.1171548,0.1548117,0.1297071,0.1799163,0.125523,0.1213389,0.1338912,0.1213389,0.1422594,0.1297071,0.125523,0.125523,0.083682,0.1338912,0.125523,0.0878661,0.0920502,0.1129707,0.0920502,0.1171548,0.1046025,0.0585774,0.0794979,0.1004184,0.0585774,0.0711297,0.0585774,0.1046025,0.0585774,0.0878661,0.0962343,0.083682,0.0753138,0.0669456,0.0543933,0.083682,0.0669456,0.0460251,0.0543933,0.1087866,0.0794979,0.0585774,0.0711297,0.0585774,0.0585774,0.0585774,0.0502092,0.0502092,0.0460251,0.0502092,0.0543933,0.0543933,0.0585774,0.0460251,0.0334728,0.0460251,0.041841,0.0334728,0.0502092,0.0167364,0.0251046,0.041841,0.0292887,0.0376569,0.041841,0.0543933,0.0251046,0.0167364,0.0209205,0.041841,0.0251046,0.0167364,0.0376569,0.0292887,0.0251046,0.0209205,0.0251046,0.0251046,0.0083682,0.0167364,0.0083682,0.0125523,0.0251046,0.0292887,0.0292887,0.0083682,0.0167364,0.0167364,0.0292887,0.0125523,0.0041841,0.0167364,0.0167364,0.0041841,0.0209205,0,0.0167364,0.0125523,0.0125523,0.0125523,0,0.0125523,0,0.0083682,0.0125523,0.0083682,0.0167364,0.0041841,0.0125523,0.0125523,0.0041841,0.0083682,0.0125523,0,0.0041841,0.0125523,0,0.0083682,0.0041841,0.0125523,0.0083682,0.0167364,0.0083682,0.0041841,0.0167364,0.0083682,0.0041841,0.0041841,0,0.0041841,0.0167364,0,0,0.0041841,0,0.0041841,0,0,0.0041841,0.0041841,0.0041841,0.0041841,0.0167364,0.0041841,0.0125523,0,0,0.0041841,0,0,0,0,0.0041841,0,0,0.0041841,0.0041841,0,0.0083682,0.0041841,0,0,0,0,0,0.0083682,0,0,0.0041841,0,0,0.0041841,0.0041841,0,0,0,0,0,0,0,0,0,0,0.0041841};
	TOPtop_four_core(feature_in1[0],feature_in2[0],feature_in3[0],feature_in4[0],
			lifetime_o1,lifetime_o2,lifetime_o3,lifetime_o4);

	int fixed_point=1;
	printf("*****************LIFETIME PRINT********************\n"
			"**************************************\n");
	if  (fixed_point)
	{
		std::cout << "tau_inten=" << lifetime_o1[0] << '\n';
		std::cout << "tau_amp=" << lifetime_o1[1] << '\n';
		std::cout << "tau_inten=" << lifetime_o2[0] << '\n';
		std::cout << "tau_amp=" << lifetime_o2[1] << '\n';
		std::cout << "tau_inten=" << lifetime_o3[0] << '\n';
		std::cout << "tau_amp=" << lifetime_o3[1] << '\n';
		std::cout << "tau_inten=" << lifetime_o4[0] << '\n';
		std::cout << "tau_amp=" << lifetime_o4[1] << '\n';
	}
	else
	{
		printf("tau_inten=%f\n",lifetime_o1[0]);
		printf("tau_amp=%f\n",lifetime_o1[1]);
		printf("tau_inten=%f\n",lifetime_o2[0]);
		printf("tau_amp=%f\n",lifetime_o2[1]);
		printf("tau_inten=%f\n",lifetime_o3[0]);
		printf("tau_amp=%f\n",lifetime_o3[1]);
		printf("tau_inten=%f\n",lifetime_o4[0]);
		printf("tau_amp=%f\n",lifetime_o4[1]);
	}
	return 0;
}
